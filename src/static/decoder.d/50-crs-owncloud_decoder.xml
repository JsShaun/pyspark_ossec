
<collection shelf="decoder">
<decoder name="owncloud">
  <prematch_pcre2>^\{"reqId":"\S+","message":".+","level":\d,"time":".+"\}$|^\{"app":"\S+","message":".+","level":\d,"time":".+"\}$|^\{"reqId":"\S+","level":\d,"time":"\S+","message":".+"\}$</prematch_pcre2>
</decoder>

<decoder name="owncloud">
  <program_name_pcre2>^ownCloud</program_name_pcre2>
</decoder>

<decoder name="owncloud-failed1">
  <parent>owncloud</parent>
  <prematch_pcre2>Login failed: user </prematch_pcre2>
  <pcre2 offset="after_prematch">^'([A-Za-z0-9@_-]+)' , wrong password, IP:(\S+)</pcre2>

  <order>user, srcip</order>
</decoder>

<decoder name="owncloud-failed2">
  <parent>owncloud</parent>

  <prematch_pcre2>Login failed: </prematch_pcre2>
  <pcre2 offset="after_prematch">^'([A-Za-z0-9@_-]+)' \(Remote IP: '(\S+)'|^'([A-Za-z0-9@_-]+)' \(Remote IP: '(\S+)\)</pcre2>
  <order>user, srcip</order>
</decoder>

<decoder name="owncloud-malicious">
  <parent>owncloud</parent>

  <prematch_pcre2>Passed filename is not valid, might be malicious </prematch_pcre2>
  <pcre2 offset="after_prematch">;ip:"(\S+)"|;ip:\\"(\S+)\\"</pcre2>

  <order>srcip</order>
</decoder>

<decoder name="owncloud-loglevel">
  <parent>owncloud</parent>
  <prematch_pcre2>","level":</prematch_pcre2>
  <pcre2 offset="after_prematch">^(\d),"</pcre2>
  <order>status</order>
</decoder>


</collection>